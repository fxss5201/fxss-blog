import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a,o as t}from"./app-Bw5SN2Fa.js";const l={};function e(p,i){return t(),n("div",null,i[0]||(i[0]=[a(`<p>关于 nginx 的 gzip ，可以分为两种：</p><ol><li>nginx 动态压缩，对每个请求先压缩再输出。</li><li>nginx 静态压缩，使用现成的扩展名为 .gz 的预压缩文件。</li></ol><h2 id="nginx-动态压缩" tabindex="-1"><a class="header-anchor" href="#nginx-动态压缩"><span>nginx 动态压缩</span></a></h2><p>开启 nginx 动态压缩只需要在 nginx.conf 文件中做如下修改即可：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 开启和关闭gzip模式</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gizp压缩起点，文件大于1k才进行压缩</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_min_length </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1k</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置压缩所需要的缓冲区大小，以4k为单位，如果文件为7k则申请2*4k的缓冲区 </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_buffers </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 16k</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置gzip压缩针对的HTTP协议版本</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_http_version </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gzip 压缩级别，1-9，数字越大压缩的越好，也越占用CPU时间</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_comp_level </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 进行压缩的文件类型</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_types </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">text/plain application/javascript text/css application/xml;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 是否在http header中添加Vary: Accept-Encoding，建议开启</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_vary </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="nginx-静态压缩" tabindex="-1"><a class="header-anchor" href="#nginx-静态压缩"><span>nginx 静态压缩</span></a></h2><p>nginx 静态压缩需要使用 <a href="http://nginx.org/en/docs/http/ngx_http_gzip_static_module.html#gzip_static" target="_blank" rel="noopener noreferrer">ngx_http_gzip_static_module</a> 模块，先简单看一下介绍：</p><p>ngx_http_gzip_static_module 模块允许发送扩展名为 .gz 的预压缩文件，而不是常规文件。</p><p>默认情况下未构建此模块，应使用 <code>--with-http_gzip_static_module</code> 配置参数启用它 。</p><p>在安装包目录编译安装：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">./</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">configure</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> --with-http_gzip_static_module</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>例如 <a href="https://www.runoob.com/linux/nginx-install-setup.html" target="_blank" rel="noopener noreferrer">Nginx 安装配置</a> 安装 Nginx 第4步编译安装，在第一步<code>./configure --prefix=/usr/local/webserver/nginx --with-http_stub_status_module --with-http_ssl_module --with-pcre=/usr/local/src/pcre-8.35</code> 之后加上 <code>--with-http_gzip_static_module</code>。</p><p>然后修改 nginx.conf 配置文件：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_static </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_proxied </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">expired no-cache no-store private auth;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>nginx 动态压缩 和 静态压缩结合使用会更好：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_static </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_proxied </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">expired no-cache no-store private auth;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_min_length </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1k</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_buffers </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 16k</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_http_version </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_comp_level </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_types </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">text/plain application/javascript text/css application/xml;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_vary </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>首先尝试使用静态压缩，如果有则返回 .gz 的预压缩文件，否则尝试动态压缩。</p>`,17)]))}const r=s(l,[["render",e]]),d=JSON.parse('{"path":"/framework/nginx%20%E9%85%8D%E7%BD%AE%20gzip_static.html","title":"nginx 配置 gzip_static","lang":"zh-CN","frontmatter":{"title":"nginx 配置 gzip_static","isOriginal":true,"category":["nginx"],"date":"2020-06-03T00:00:00.000Z","description":"关于 nginx 的 gzip ，可以分为两种： nginx 动态压缩，对每个请求先压缩再输出。 nginx 静态压缩，使用现成的扩展名为 .gz 的预压缩文件。 nginx 动态压缩 开启 nginx 动态压缩只需要在 nginx.conf 文件中做如下修改即可： nginx 静态压缩 nginx 静态压缩需要使用 ngx_http_gzip_sta...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"nginx 配置 gzip_static\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2020-06-03T00:00:00.000Z\\",\\"dateModified\\":\\"2022-11-13T07:46:29.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"fxss\\",\\"url\\":\\"https://github.com/fxss5201\\"}]}"],["meta",{"property":"og:url","content":"https://blog.fxss.work/fxss-blog/framework/nginx%20%E9%85%8D%E7%BD%AE%20gzip_static.html"}],["meta",{"property":"og:site_name","content":"fxss 个人博客"}],["meta",{"property":"og:title","content":"nginx 配置 gzip_static"}],["meta",{"property":"og:description","content":"关于 nginx 的 gzip ，可以分为两种： nginx 动态压缩，对每个请求先压缩再输出。 nginx 静态压缩，使用现成的扩展名为 .gz 的预压缩文件。 nginx 动态压缩 开启 nginx 动态压缩只需要在 nginx.conf 文件中做如下修改即可： nginx 静态压缩 nginx 静态压缩需要使用 ngx_http_gzip_sta..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2022-11-13T07:46:29.000Z"}],["meta",{"property":"article:published_time","content":"2020-06-03T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2022-11-13T07:46:29.000Z"}]]},"git":{"createdTime":1668325589000,"updatedTime":1668325589000,"contributors":[{"name":"fxss","username":"fxss","email":"723107234@qq.com","commits":1,"url":"https://github.com/fxss"}]},"readingTime":{"minutes":1.51,"words":454},"filePathRelative":"framework/nginx 配置 gzip_static.md","excerpt":"<p>关于 nginx 的 gzip ，可以分为两种：</p>\\n<ol>\\n<li>nginx 动态压缩，对每个请求先压缩再输出。</li>\\n<li>nginx 静态压缩，使用现成的扩展名为 .gz 的预压缩文件。</li>\\n</ol>\\n<h2>nginx 动态压缩</h2>\\n<p>开启 nginx 动态压缩只需要在 nginx.conf 文件中做如下修改即可：</p>\\n<div class=\\"language-nginx line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"nginx\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 开启和关闭gzip模式</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">gzip </span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">on</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># gizp压缩起点，文件大于1k才进行压缩</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">gzip_min_length </span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">1k</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 设置压缩所需要的缓冲区大小，以4k为单位，如果文件为7k则申请2*4k的缓冲区 </span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">gzip_buffers </span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">4</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> 16k</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 设置gzip压缩针对的HTTP协议版本</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">gzip_http_version </span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">1.0</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># gzip 压缩级别，1-9，数字越大压缩的越好，也越占用CPU时间</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">gzip_comp_level </span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">2</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 进行压缩的文件类型</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">gzip_types </span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">text/plain application/javascript text/css application/xml;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 是否在http header中添加Vary: Accept-Encoding，建议开启</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">gzip_vary </span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">on</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{r as comp,d as data};
